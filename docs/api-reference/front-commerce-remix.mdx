---
title: "@front-commerce/remix"
sidebar_position: 2
description:
  "This package contains Front-Commerce implementations related to Remix."
---

<p>{frontMatter.description}</p>

## Installation

First ensure you have installed the package:

```bash
$ pnpm install @front-commerce/remix@latest
```

## Type Safety

You can get type safety over the network for your loaders with
[LoaderArgs](https://remix.run/docs/en/1.16.0/route/loader#type-safety) and for
your actions with
[ActionArgs](https://remix.run/docs/en/1.16.0/route/action#action). To ensure
that the typed frontCommerce context is in the arguments, you can add the
`@front-commerce/remix` reference to your `remix.env.d.ts` file.

```ts
/// <reference types="@remix-run/dev" />
/// <reference types="@remix-run/node" />
// highlight-next-line
/// <reference types="@front-commerce/remix" />
```

## Front-Commerce Context

To ensure the Front-Commerce Context is available in your loaders and actions,
you need to add it to your server via the
[`getLoadContext`](https://remix.run/docs/en/1.16.0/route/loader#context), to do
this, update your
[`server.ts`](https://gitlab.blackswift.cloud/front-commerce/front-commerce/-/blob/b99f0475ce494591a54fdc2b904e956a083e9b51/skeleton/server.ts)

```ts
// add-start
import { createFrontCommerceContext } from "@front-commerce/remix";
import { createRemixRequest } from "@remix-run/express/dist/server";
// add-end

app.all(
  "*",
  createRequestHandler({
    build: require(BUILD_DIR),
    mode: process.env.NODE_ENV,
    // add-start
    getLoadContext(request, response) {
      const remixRequest = createRemixRequest(request, response);
      return {
        frontCommerce: createFrontCommerceContext(remixRequest),
      };
    },
    // add-end
  })
);
```

## FrontCommerceApp

The `FrontCommerceApp` instance uses the `frontCommerce` context to expose
different API's which can be used in your Application.

To create the `FrontCommerceApp` Instance you can add it to your loaders or
actions.

```ts
import type { LoaderArgs, ActionArgs } from "@remix-run/node";
import { FrontCommerceApp } from "@front-commerce/remix";

export const loader = ({ context }: LoaderArgs) => {
  const app = new FrontCommerceApp(context.frontCommerce);
  // your loader logic here
};

export const action = ({ context }: ActionArgs) => {
  const app = new FrontCommerceApp(context.frontCommerce);
  // your action logic here
};
```

### API Reference

### `app.user`

Exposes the current user information.

```ts
interface User {
  clientIp: string;
}
```

### `app.env`

Exposes the current environment information. If the `FRONT_COMMERCE_ENV` has
been set, it will use that, otherwise fallback to `process.env.NODE_ENV`.

```ts
type Environment = "production" | "development" | "test";
```

### `app.request`

Exposes the
[Remix NodeRequest](https://github.com/remix-run/remix/blob/410e9d8aac044b3453c1dddbeb0bcc1d53cdec68/packages/remix-node/fetch.ts#LL34C1-L46C2)
request.

This is essentially the same request which you will find in your `loader` or
`action` functions.

### `app.graphql`

Exposes the graphql client.

- `query` - Executes a graphql query.
- `mutate` - Executes a graphql mutation.

```ts
export const loader = ({ context }: LoaderArgs) => {
  const app = new FrontCommerceApp(context.frontCommerce);

  const result = app.graphql.query(/* GraphQL */ `
    query {
      products {
        items {
          id
          name
        }
      }
    }
  `);

  // your loader logic here
};

export const action = ({ context }: ActionArgs) => {
  const app = new FrontCommerceApp(context.frontCommerce);

  const result = app.graphql.mutate(
    /* GraphQL */ `
    mutation AddToCart($input: AddToCartInput!)) {
      addToCart(input: $input) {
        cart {
          items {
            id
            name
          }
        }
      }
    }
  `,
    { sku: "123", quantity: 1 }
  );

  // your action logic here
};
```
